Final version of snake learning
